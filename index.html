<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="./style.css" crossorigin="anonymous">

        <script type="module" src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js"></script>
        <script type="module">
            let placeholder_info = {
                "maquina1": { pes: 20, foto: "maquina1.jpg" },
                "maquina2": { pes: 15, foto: "maquina2.jpg" },
                "maquina3": { pes: 25, foto: "maquina3.jpg" },
                "maquina4": { pes: 30, foto: "maquina4.jpg" },
                "maquina5": { pes: 40, foto: "maquina5.jpg" }
            };

            Cookies.set("info", JSON.stringify(placeholder_info), { expires: 999999, sameSite: 'Lax' });
            console.log(Cookies.get("info"));
        </script>
    </head>
    <body>
        <div class="placeholders" style="display: none;">
            <!-- MÃ€QUINA PLACEHOLDER -->
            <div id="maquina-placeholder">
                <div class="foto-container">
                    <img src="./fotos/{FOTO}" />
                </div>
                <div class="input-container">
                    <input type="number" min="0" max="100" step="5" value="{PES}" />
                </div>
            </div>
        </div>

        <div id="container">
            <div id="maquines">
                <script type="module">
                    let info = JSON.parse(Cookies.get("info"));
                    let pesos_maquines = Object.values(info);

                    let divs_maquines = pesos_maquines.map(function (maquina) {
                        let placeholder = document.getElementById("maquina-placeholder");
                        
                        // Clone placeholder and turn into element
                        let element = placeholder.cloneNode(true);
                        element.removeAttribute('id');
                        element.classList.add('maquina');

                        // Turn element to string and replace
                        let string = element.outerHTML;
                        string = string.replace('{FOTO}', maquina.foto);
                        string = string.replace('{PES}', maquina.pes);

                        return string;
                    });

                    // Put HTML value in div
                    document.getElementById("maquines").innerHTML = divs_maquines.join('\n');
                </script>
            </div>

            <div class="save">
                <button>Fer el dia</button>
            </div>
        </div>
    </body>
</html>